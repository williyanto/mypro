<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Video Player</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background-color: black;
      font-family: sans-serif;
      overflow: hidden;
    }

    .video-wrapper {
      height: 100vh;
      overflow-y: scroll;
      scroll-snap-type: y mandatory;
    }

    .video-container {
      height: 100vh;
      scroll-snap-align: start;
      position: relative;
    }

    video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .controls {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }

    .controls button {
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      font-size: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bottom-info {
      position: absolute;
      bottom: 90px;
      left: 10px;
      right: 10px;
      z-index: 10;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      color: white;
      background: rgba(0, 0, 0, 0.5);
      padding: 8px;
      border-radius: 10px;
    }

    .bottom-info img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .bottom-navbar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 8px 0;
      z-index: 200;
    }

    .bottom-navbar div {
      color: white;
      font-size: 12px;
      text-align: center;
      flex: 1;
    }

    .bottom-navbar i {
      font-size: 22px;
    }

    .right-navbar {
      position: fixed;
      right: 10px;
      top: 30%;
      z-index: 150;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .right-navbar button {
      background: rgba(0, 0, 0, 0.5);
      border: none;
      color: white;
      padding: 10px;
      border-radius: 50%;
      font-size: 18px;
    }

    #videoInput {
      display: none;
    }
  </style>
</head>
<body>
  <!-- File input (hidden) -->
  <input type="file" id="videoInput" multiple accept="video/*">

  <!-- Right Navbar -->
  <div class="right-navbar">
    <button><i class="fas fa-thumbs-up"></i></button>
    <button><i class="fas fa-thumbs-down"></i></button>
    <button><i class="fas fa-comment"></i></button>
    <button><i class="fas fa-share"></i></button>
    <button onclick="repeatVideo()"><i class="fas fa-redo"></i></button>
  </div>

  <!-- Video Display -->
  <div class="video-wrapper" id="videoWrapper"></div>

  <!-- Bottom Navbar -->
  <div class="bottom-navbar">
    <div><i class="fas fa-home"></i><br>Home</div>
    <div><i class="fas fa-film"></i><br>Shorts</div>
    <div onclick="document.getElementById('videoInput').click()">
      <i class="fas fa-plus-circle"></i><br>Upload
    </div>
    <div><i class="fas fa-video"></i><br>Subs</div>
    <div><i class="fas fa-user"></i><br>You</div>
  </div>

  <script>
    const videoInput = document.getElementById('videoInput');
    const videoWrapper = document.getElementById('videoWrapper');
    let videoList = [];
    let currentIndex = 0;

    videoInput.addEventListener('change', function () {
      videoList = Array.from(this.files);
      if (videoList.length > 0) {
        videoWrapper.innerHTML = '';
        shuffle(videoList);
        videoList.forEach((file, index) => {
          const url = URL.createObjectURL(file);
          const container = document.createElement('div');
          container.className = 'video-container';
          container.innerHTML = `
            <video src="${url}" ${index === 0 ? 'autoplay' : ''} playsinline></video>
            <div class="controls">
              <button onclick="togglePlayPause(this)">
                <i class="fas fa-pause"></i>
              </button>
            </div>
            <div class="bottom-info">
              <img src="https://via.placeholder.com/40" alt="avatar">
              <span class="me-auto">@aqsa1610</span>
              <button class="btn btn-danger btn-sm">Subscribe</button>
            </div>
          `;
          videoWrapper.appendChild(container);
        });
        playVideoAtIndex(0);
      }
    });

    function togglePlayPause(btn) {
      const video = btn.closest('.video-container').querySelector('video');
      if (video.paused) {
        video.play();
        btn.innerHTML = '<i class="fas fa-pause"></i>';
      } else {
        video.pause();
        btn.innerHTML = '<i class="fas fa-play"></i>';
      }
    }

    function playVideoAtIndex(index) {
      const videos = document.querySelectorAll('video');
      videos.forEach((v, i) => {
        if (i === index) {
          v.currentTime = 0;
          v.muted = false;
          v.play();
        } else {
          v.pause();
        }

        v.onended = () => {
          currentIndex = Math.floor(Math.random() * videoList.length);
          const nextVideo = document.querySelectorAll('.video-container')[currentIndex];
          nextVideo.scrollIntoView({ behavior: 'smooth' });
          playVideoAtIndex(currentIndex);
        };
      });
    }

    function repeatVideo() {
      const video = document.querySelectorAll('video')[currentIndex];
      video.currentTime = 0;
      video.play();
    }

    videoWrapper.addEventListener('scroll', () => {
      const videos = document.querySelectorAll('.video-container');
      videos.forEach((container, index) => {
        const rect = container.getBoundingClientRect();
        if (rect.top >= 0 && rect.bottom <= window.innerHeight + 200) {
          currentIndex = index;
          playVideoAtIndex(index);
        }
      });
    });

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }
  </script>
</body>
</html>
