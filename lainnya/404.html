<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Video Player</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body, html {
      height: 100%;
      margin: 0;
      overflow: hidden;
      font-family: sans-serif;
    }

    .container-fluid {
      height: 100%;
      display: flex;
    }

    .video-wrapper {
      flex: 1;
      position: relative;
      overflow-y: scroll;
      scroll-snap-type: y mandatory;
      padding-bottom: 150px;
      background: black;
    }

    .video-container {
      height: 100vh;
      scroll-snap-align: start;
      position: relative;
    }

    video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .controls {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }

    .controls button {
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      box-shadow: 0 0 6px rgba(0, 0, 0, 0.6);
    }

    .bottom-info {
      position: absolute;
      bottom: 120px;
      left: 10px;
      right: 10px;
      z-index: 10;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      color: white;
      background: rgba(0, 0, 0, 0.4);
      padding: 8px;
      border-radius: 10px;
    }

    .bottom-info img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .sidebar {
      width: 60px;
      background: #000;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 20px;
    }

    .sidebar i {
      color: white;
      font-size: 22px;
      margin: 20px 0;
    }

    .file-picker {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 100;
    }
  </style>
</head>
<body>
  <div class="container-fluid">
    <!-- Sidebar -->
    <div class="sidebar">
      <i class="fas fa-home"></i>
      <i class="fas fa-film"></i>
      <i class="fas fa-video"></i>
      <i class="fas fa-user"></i>
      <i class="fas fa-thumbs-up"></i>
      <i class="fas fa-thumbs-down"></i>
      <i class="fas fa-share"></i>
    </div>

    <!-- Video Picker & Wrapper -->
    <div class="video-wrapper" id="videoWrapper">
      <input class="file-picker form-control form-control-sm" type="file" id="videoInput" multiple accept="video/*">

      <!-- Tempat video akan muncul -->
    </div>
  </div>

  <script>
    const videoInput = document.getElementById('videoInput');
    const videoWrapper = document.getElementById('videoWrapper');
    let videoList = [];
    let currentIndex = 0;

    videoInput.addEventListener('change', function () {
      videoList = Array.from(this.files);
      if (videoList.length > 0) {
        videoWrapper.innerHTML = ''; // Kosongkan dulu
        shuffle(videoList);
        videoList.forEach((file, index) => {
          const url = URL.createObjectURL(file);
          const container = document.createElement('div');
          container.className = 'video-container';

          container.innerHTML = `
            <video src="${url}" ${index === 0 ? 'autoplay' : ''} preload="auto"></video>
            <div class="controls">
              <button onclick="togglePlayPause(this)">
                <i class="fas fa-pause"></i>
              </button>
            </div>
            <div class="bottom-info">
              <img src="https://via.placeholder.com/40" alt="avatar">
              <span class="me-auto">@aqsa1610</span>
              <button class="btn btn-danger btn-sm">Subscribe</button>
            </div>
          `;
          videoWrapper.appendChild(container);
        });
        playVideoAtIndex(0);
      }
    });

    function playVideoAtIndex(index) {
      const videos = document.querySelectorAll('video');
      videos.forEach((v, i) => {
        if (i === index) {
          v.play();
          v.currentTime = 0;
        } else {
          v.pause();
        }
      });
    }

    function togglePlayPause(btn) {
      const video = btn.closest('.video-container').querySelector('video');
      if (video.paused) {
        video.play();
        btn.innerHTML = '<i class="fas fa-pause"></i>';
      } else {
        video.pause();
        btn.innerHTML = '<i class="fas fa-play"></i>';
      }
    }

    // Auto scroll detect
    videoWrapper.addEventListener('scroll', () => {
      const videos = document.querySelectorAll('.video-container');
      videos.forEach((container, index) => {
        const rect = container.getBoundingClientRect();
        if (rect.top >= 0 && rect.bottom <= window.innerHeight + 200) {
          currentIndex = index;
          playVideoAtIndex(index);
        }
      });
    });

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }
  </script>
</body>
</html>
