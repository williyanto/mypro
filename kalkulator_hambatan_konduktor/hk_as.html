<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Kalkulator Hambatan Konduktor AS/NZS v7</title>
    <link rel="icon" type="image/png" href="logo_as.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
    <style>
        :root {
            --bg-color: #f5f5f5;
            --text-color: #000;
            --border-color: #ccc;
            --input-bg: #fff;
            --button-bg: #007bff;
            --button-text: #fff;
            --button-hover: #0056cc;
            --footer-color: #777;
            --divider: #ddd;
            --info-bg: #e8f5ff;
            --info-border: #90caf9;
            --info-color: #1976d2;
        }
        body.dark {
            --bg-color: #121212;
            --text-color: #eee;
            --border-color: #444;
            --input-bg: #1e1e1e;
            --button-bg: #4444ff;
            --button-text: #fff;
            --button-hover: #2222aa;
            --footer-color: #aaa;
            --divider: #555;
            --info-bg: #222b38;
            --info-border: #1976d2;
            --info-color: #90caf9;
        }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container-main {
            background: var(--input-bg);
            padding: 32px 24px;
            border-radius: 20px;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.07);
            border: 1px solid var(--border-color);
            position: relative;
            margin: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .title-main {
            text-align: center;
            font-weight: 700;
            font-size: 1.4rem;
            margin-bottom: 8px;
        }
        .divider {
            height: 1px;
            width: 100%;
            background: var(--divider);
            margin: 12px 0 24px 0;
        }
        .info-area {
            display: flex;
            align-items: center;
            gap: 7px;
            background: var(--info-bg);
            border: 1.5px solid var(--info-border);
            border-radius: 10px;
            padding: 10px 14px 10px 12px;
            margin: 0 auto 20px auto;
            transition: box-shadow 0.2s;
            box-shadow: 0 3px 10px rgba(25, 118, 210, 0.07);
            cursor: pointer;
            user-select: none;
            min-width: 32px;
            max-width: 400px;
            justify-content: flex-start;
        }
        .info-area.compact {
            background: transparent;
            border: none;
            padding: 0;
            box-shadow: none;
            margin: 0;
            min-width: 32px;
            width: 32px;
            max-width: none;
            display: inline-flex;
            align-items: center;
        }
        .info-area .info-icon {
            flex-shrink: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            color: var(--info-color);
            cursor: pointer;
            border-radius: 50%;
            transition: background 0.2s;
        }
        .info-area.compact .info-icon:active,
        .info-area.compact .info-icon:focus {
            background: var(--info-bg);
            outline: none;
        }
        .info-text {
            font-size: 1rem;
            color: var(--info-color);
            font-weight: 500;
            line-height: 1.45;
            margin-left: 2px;
            margin-top: 1px;
        }
        .info-text strong {
            display: block;
            margin-bottom: 2px;
            font-weight: 700;
            font-size: 1.04em;
        }
        .info-area-gap {
            height: 20px;
            width: 100%;
            display: block;
        }
        .form-row {
            display: flex !important;
            flex-direction: row !important;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: nowrap !important;
        }
        .form-group {
            flex: 1 1 0%;
            display: flex;
            flex-direction: column;
            min-width: 0;
            width: 100%;
        }
        .form-label {
            font-size: 0.95rem;
            margin-bottom: 6px;
            font-weight: 500;
        }
        .form-input,
        select.form-input {
            padding: 10px 14px;
            border: 1.5px solid var(--border-color);
            border-radius: 12px;
            font-size: 0.95rem;
            background: var(--input-bg);
            color: var(--text-color);
            transition: border 0.2s;
            width: 100%;
        }
        .form-input:focus {
            border-color: var(--button-bg);
            outline: none;
        }
        /* Placeholder style */
        .form-input::placeholder {
            font-style: italic;
            color: var(--footer-color); /* Make it subtle */
        }
        .result-box {
            border: 1.5px solid var(--border-color);
            border-radius: 12px;
            text-align: center;
            padding: 12px 10px;
            font-size: 1rem;
            font-weight: 600;
            margin: 20px 0 28px 0;
            background: var(--input-bg);
        }
        #hasil-status {
            font-size: 0.88rem;
            margin-top: 4px;
        }
        .hint-green {
            color: green;
            font-style: italic;
            font-size: 1rem;
            font-weight: 500;
            margin-top: 8px;
            margin-bottom: 3px;
            display: block;
        }
        .green-text { /* CSS untuk teks hijau */
            color: green;
            font-weight: 600;
        }
        #spec-tabel-display {
            font-size: 0.88rem;
            margin-top: 10px; /* Margin atas untuk memisahkan dari result-box */
            color: var(--text-color);
            text-align: left; /* Rata kiri */
            font-weight: normal; /* Tidak tebal */
        }

        /* --- BUTTONS GRID --- */
        .btn-section {
            margin-top: 32px;
            margin-bottom: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: stretch;
            justify-content: center;
        }
        .btn-row1, .btn-row2, .btn-row3 {
            display: flex;
            gap: 10px;
            justify-content: center !important;
            align-items: center;
            width: 100%;
        }
        .btn-row3 {
            gap: 10px;
        }
        .btn-row3 .main-btn {
            flex: 1 0 auto;
            min-width: 100px;
            max-width: 180px;
            text-align: center;
        }
        .btn-row3 .right-actions {
            display: flex;
            gap: 6px;
            margin-left: 0;
            align-items: center;
        }
        .main-btn {
            padding: 8px 18px;
            background: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 999px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            min-width: 0;
            flex: 1;
            max-width: 180px;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .main-btn:hover {
            background: var(--button-hover);
        }
        .icon-btn {
            background: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 50%;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.25rem;
            transition: background 0.2s;
            margin-right: 2px;
        }
        .icon-btn:hover {
            background: var(--button-hover);
        }
        .footer-main {
            margin-top: 20px;
            text-align: center;
            font-size: 0.85rem;
            color: var(--footer-color);
        }
        .footer-main::before {
            content: "";
            display: block;
            width: 100%;
            height: 1px;
            background: var(--divider);
            margin-bottom: 12px;
        }
        #hasil-nilai {
            display: flex; /* Menggunakan flexbox untuk mensejajarkan teks dan satuan */
            justify-content: center; /* Pusatkan konten horizontal */
            align-items: baseline; /* Sejajarkan berdasarkan baseline teks */
            gap: 5px; /* Jarak antara angka dan satuan */
        }


        @media (max-width: 480px) {
            .container-main {
                max-width: 99vw;
                padding: 20px 4vw;
                border-radius: 8px;
            }
            .form-row { flex-direction: row !important; gap: 12px !important; flex-wrap: nowrap !important; }
            .btn-section { gap: 9px; }
            .btn-row1, .btn-row2, .btn-row3 { gap: 9px; flex-wrap: wrap; justify-content: center !important; }
            .btn-row3 { justify-content: center !important; }
            .main-btn { max-width: 100%; padding: 8px 8px; font-size: 0.92rem; }
            .icon-btn { width: 34px; height: 34px; font-size: 1.08rem; }
            .info-text { font-size: 0.98em; }
            .info-area { padding: 10px 7px 10px 8px; }
            .info-area.compact { min-width: 28px; }
            .info-area-gap { height: 16px; }
            .title-main { font-size: 1.1rem; }
        }

        @media print {
            body {
                background: white !important;
                color: black !important;
            }
            .btn-section, .footer-main, .info-area {
                display: none !important;
            }
            .container-main {
                border: none;
                box-shadow: none;
                padding: 0;
                max-width: 100%;
            }
            .divider {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container-main">
        <div class="title-main">Kalkulator Hambatan Konduktor AS/NZS v7</div>
        <div class="divider"></div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label" for="alat">Pembacaan Alat</label>
                <div style="display: flex; gap: 8px;">
                    <input type="text" class="form-input" id="alat" style="flex:1;" inputmode="decimal" pattern="[0-9]*" placeholder="dalam satuan mÎ©" />
                </div>
            </div>
            <div class="form-group">
                <label class="form-label" for="panjang">Panjang</label>
                <input type="text" class="form-input" id="panjang" inputmode="decimal" pattern="[0-9]*" placeholder="dalam satuan meter" />
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label" for="suhu">Suhu</label>
                <input type="text" class="form-input" id="suhu" inputmode="decimal" pattern="[0-9]*" placeholder="dalam Â°C" />
            </div>
            <div class="form-group">
                <label class="form-label" for="faktor">Faktor Koreksi Suhu</label>
                <input type="text" class="form-input" id="faktor" readonly />
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label" for="bahan">Konduktor</label>
                <select class="form-input" id="bahan">
                    <option value="CU">CU</option>
                    <option value="AL">AL</option>
                    <option value="TCU">TCU</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label" for="luas">Penampang</label>
                <select class="form-input" id="luas">
                        <option value="0,5">0,5 mmÂ²</option>
                        <option value="0,75">0,75 mmÂ²</option>
                        <option value="1,0">1,0 mmÂ²</option>
                        <option value="1,5">1,5 mmÂ²</option>
                        <option value="2,5">2,5 mmÂ²</option>
                        <option value="4">4 mmÂ²</option>
                        <option value="6">6 mmÂ²</option>
                        <option value="10">10 mmÂ²</option>
                        <option value="16">16 mmÂ²</option>
                        <option value="25">25 mmÂ²</option>
                        <option value="35">35 mmÂ²</option>
                        <option value="50">50 mmÂ²</option>
                        <option value="70">70 mmÂ²</option>
                        <option value="95">95 mmÂ²</option>
                        <option value="120">120 mmÂ²</option>
                        <option value="150">150 mmÂ²</option>
                        <option value="185">185 mmÂ²</option>
                        <option value="240">240 mmÂ²</option>
                        <option value="300">300 mmÂ²</option>
                        <option value="400">400 mmÂ²</option>
                        <option value="500">500 mmÂ²</option>
                        <option value="630">630 mmÂ²</option>
                        <option value="800">800 mmÂ²</option>
                        <option value="960">960 mmÂ²</option>
                        <option value="1000">1000 mmÂ²</option>
                        <option value="1200">1200 mmÂ²</option>
                        <option value="1600">1600 mmÂ²</option>
                        <option value="2000">2000 mmÂ²</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label" for="spesifikasi">Spec. Max</label>
                <input type="text" class="form-input" id="spesifikasi" readonly />
            </div>
        </div>

        <div class="result-box" id="hasil">
            <div id="hasil-nilai">
                <span id="nilai-utama"></span>
                <span id="unit-ohm-km" style="color:var(--text-color); display: none;">Î©/km</span>
            </div>
            <div id="hasil-status"></div>
        </div>

        <div id="spec-tabel-display"></div> 

        <div class="btn-section" id="btnSection">
            <div class="btn-row1">
                <button class="main-btn" id="btn-iec">Spek. IEC</button>
                <button class="main-btn" id="btn-icea">Spek. ICEA</button>
                <button class="main-btn" id="btn-asnzs">Spek. AS</button>
            </div>
            <div class="btn-row2">
                <button class="main-btn" id="btn-spln">Spek. SPLN</button>
                <button class="main-btn" id="btn-simpan">Simpan Pengujian</button>
            </div>
            <div class="btn-row3">
                <div class="right-actions">
                    <button class="icon-btn" id="toggleMode" title="Toggle Dark/Light" aria-label="Toggle Dark/Light">
                        <span id="toggleIcon">
                            <svg id="icon-sun" width="22" height="22" viewBox="0 0 22 22" fill="none">
                                <circle cx="11" cy="11" r="5" stroke="currentColor" stroke-width="2"/>
                                <g stroke="currentColor" stroke-width="2">
                                    <line x1="11" y1="2" x2="11" y2="5"/>
                                    <line x1="11" y1="17" x2="11" y2="20"/>
                                    <line x1="2" y1="11" x2="5" y2="11"/>
                                    <line x1="17" y1="11" x2="20" y2="11"/>
                                    <line x1="5.22" y1="5.22" x2="7.07" y2="7.07"/>
                                    <line x1="14.93" y1="14.93" x2="16.78" y2="16.78"/>
                                    <line x1="16.78" y1="5.22" x2="14.93" y2="7.07"/>
                                    <line x1="7.07" y1="14.93" x2="5.22" y2="16.78"/>
                                </g>
                            </svg>
                        </span>
                    </button>
                </div>
                <button class="main-btn" id="btn-laporan">Laporan</button>
                <div class="right-actions">
                    <span id="infoArea" class="info-area compact" tabindex="0" aria-label="Tampilkan informasi aplikasi" title="Informasi">
                        <span class="info-icon" id="infoIcon">
                            <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
                                <circle cx="11" cy="11" r="10" stroke="currentColor" stroke-width="2"/>
                                <rect x="10" y="10" width="2" height="7" rx="1" fill="currentColor"/>
                                <rect x="10" y="6" width="2" height="2" rx="1" fill="currentColor"/>
                            </svg>
                        </span>
                    </span>
                </div>
            </div>
        </div>

        <div class="info-area-gap" id="infoAreaGap" style="display:none;"></div>
        <div id="infoAreaExpandedContainer"></div>

        <div class="footer-main">Made by Williyanto Adi 2025</div>
    </div>

    <script>
        // Membatasi input hanya angka & titik/koma di kolom pembacaan alat, panjang dan suhu
        function onlyNumberInput(el) {
            el.addEventListener('input', function() {
                let val = el.value;
                val = val.replace(/,/g, '.');
                val = val.replace(/[^0-9.]/g, '');
                const parts = val.split('.');
                if (parts.length > 2) {
                    val = parts[0] + '.' + parts.slice(1).join('');
                }
                el.value = val;
                hitungHasil(); // Panggil hitungHasil setiap kali input berubah
            });
        }
        onlyNumberInput(document.getElementById("alat"));
        onlyNumberInput(document.getElementById("panjang"));
        onlyNumberInput(document.getElementById("suhu"));

        // Info Area Toggle
        const infoArea = document.getElementById("infoArea");
        const infoAreaExpandedContainer = document.getElementById("infoAreaExpandedContainer");
        const infoAreaGap = document.getElementById("infoAreaGap");
        let infoExpanded = false;
        const infoContent = `
            <div class="info-area" id="infoAreaExpanded" tabindex="0">
                <span class="info-icon" id="infoIconExpanded">
                    <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <circle cx="11" cy="11" r="10" stroke="currentColor" stroke-width="2"/>
                        <rect x="10" y="10" width="2" height="7" rx="1" fill="currentColor"/>
                        <rect x="10" y="6" width="2" height="2" rx="1" fill="currentColor"/>
                    </svg>
                </span>
                <span class="info-text">
                    <strong>Tentang aplikasi ini</strong>
                    Ini adalah aplikasi untuk menghitung nilai resistansi pada konduktor Tembaga (CU) dan Aluminium (AL) dengan suhu dan panjang.
                </span>
            </div>
        `;
        function expandInfoArea() {
            if (!infoExpanded) {
                infoArea.style.display = "none";
                infoAreaGap.style.display = "block";
                infoAreaExpandedContainer.innerHTML = infoContent;
                infoExpanded = true;
                // Event untuk collapse
                const icon = document.getElementById("infoIconExpanded");
                const area = document.getElementById("infoAreaExpanded");
                icon.addEventListener("click", collapseInfoArea);
                area.addEventListener("click", function(e) {
                    if (e.target === icon || e.target.closest('.info-icon')) collapseInfoArea();
                });
                area.addEventListener("keydown", function(e) {
                    if (e.key === "Enter" || e.key === " ") {
                        collapseInfoArea();
                    }
                });
            }
        }
        function collapseInfoArea() {
            if (infoExpanded) {
                infoArea.style.display = "";
                infoAreaGap.style.display = "none";
                infoAreaExpandedContainer.innerHTML = "";
                infoExpanded = false;
            }
        }
        infoArea.addEventListener("click", expandInfoArea);
        infoArea.addEventListener("keydown", function(e) {
            if (e.key === "Enter" || e.key === " ") {
                expandInfoArea();
            }
        });

        // Accessibility: focus style for info icon
        infoArea.addEventListener("focus", function() {
            infoArea.style.outline = "2px solid var(--info-color)";
        });
        infoArea.addEventListener("blur", function() {
            infoArea.style.outline = "";
        });

        // Theme Toggle
        const toggleMode = document.getElementById("toggleMode");
        const toggleIcon = document.getElementById("toggleIcon");
        function setThemeIcon(isDark) {
            if (isDark) {
                // Moon icon
                toggleIcon.innerHTML = `
                    <svg id="icon-moon" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <path d="M17.5 14.7A7.01 7.01 0 0 1 7.3 4.5c0-.3-.3-.5-.6-.4A9 0 1 0 18 18c.2-.3-.1-.6-.5-.6z"
                            stroke="currentColor" stroke-width="2" fill="currentColor"/>
                    </svg>
                `;
            } else {
                // Sun icon
                toggleIcon.innerHTML = `
                    <svg id="icon-sun" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <circle cx="11" cy="11" r="5" stroke="currentColor" stroke-width="2"/>
                        <g stroke="currentColor" stroke-width="2">
                            <line x1="11" y1="2" x2="11" y2="5"/>
                            <line x1="11" y1="17" x2="11" y2="20"/>
                            <line x1="2" y1="11" x2="5" y2="11"/>
                            <line x1="17" y1="11" x2="20" y2="11"/>
                            <line x1="5.22" y1="5.22" x2="7.07" y2="7.07"/>
                            <line x1="14.93" y1="14.93" x2="16.78" y2="16.78"/>
                            <line x1="16.78" y1="5.22" x2="14.93" y2="7.07"/>
                            <line x1="7.07" y1="14.93" x2="5.22" y2="16.78"/>
                        </g>
                    </svg>
                `;
            }
        }
        toggleMode.addEventListener('click', () => {
            document.body.classList.toggle('dark');
            setThemeIcon(document.body.classList.contains('dark'));
        });
        setThemeIcon(document.body.classList.contains('dark'));

        // Data & Kalkulasi
        const bahanEl = document.getElementById('bahan');
        const luasEl = document.getElementById('luas');
        const spesifikasiEl = document.getElementById('spesifikasi');
        const suhuEl = document.getElementById('suhu');
        const faktorEl = document.getElementById('faktor');
        const hasilNilai = document.getElementById("hasil-nilai");
        const nilaiUtamaEl = document.getElementById("nilai-utama"); 
        const unitOhmKmEl = document.getElementById("unit-ohm-km"); // Ditambahkan: Elemen untuk unit
        const hasilStatus = document.getElementById("hasil-status");
        const hasilEl = document.getElementById("hasil");
        const alatEl = document.getElementById("alat");
        const specTabelDisplay = document.getElementById("spec-tabel-display");

        let laporanPengujian = [];

        // Data spesifikasi untuk perbandingan perhitungan (tidak berubah)
        const specData = {
            CU: { 
                "0,5": "38,4",
                "0,75": "25,3",
                "1,0": "21,2",
                "1,5": "13,6",
                "2,5": "7,41",
                "4": "4,61",
                "6": "3,08",
                "10": "1,83",
                "16": "1,15",
                "25": "0,727",
                "35": "0,524",
                "50": "0,387",
                "70": "0,268",
                "95": "0,193",
                "120": "0,153",
                "150": "0,124",
                "185": "0,0991",
                "240": "0,0754",
                "300": "0,0601",
                "400": "0,0470",
                "500": "0,0366",
                "630": "0,0283",
                "800": "0,0221",
                "960": "0,0189",
                "1000": "0,0176",
                "1200": "0,0151",
                "1600": "0,0113",
                "2000": "0,0090"
            },
            AL: { 
                "0,5": "-",
                "0,75": "-",
                "1,0": "-",
                "1,5": "-",
                "2,5": "-",
                "4": "7,41",
                "6": "4,61",
                "10": "3,08",
                "16": "1,91",
                "25": "1,20",
                "35": "0,868",
                "50": "0,641",
                "70": "0,443",
                "95": "0,320",
                "120": "0,253",
                "150": "0,206",
                "185": "0,164",
                "240": "0,125",
                "300": "0,100",
                "400": "0,0778",
                "500": "0,0605",
                "630": "0,0469",
                "800": "0,0367",
                "960": "-",
                "1000": "0,0291",
                "1200": "-",
                "1600": "-",
                "2000": "-",
            },
            TCU: {
                "0,5": "39,6",
                "0,75": "26,0",
                "1,0": "21,6",
                "1,5": "13,8",
                "2,5": "7,56",
                "4": "4,70",
                "6": "3,11",
                "10": "1,84",
                "16": "1,16",
                "25": "0,734",
                "35": "0,529",
                "50": "0,391",
                "70": "0,270",
                "95": "0,195",
                "120": "0,154",
                "150": "0,126",
                "185": "0,100",
                "240": "0,0762",
                "300": "0,0607",
                "400": "0,0475",
                "500": "0,0369",
                "630": "0,0286",
                "800": "0,0224",
                "960": "0,0189",
                "1000": "0,0177",
                "1200": "0,0151",
                "1600": "0,0113",
                "2000": "0,0090"
            }
        };

        // Data spesifikasi untuk tampilan "Nominal Diameter" (baru)
        const tabelSpecData = {
            CU: {
                "0,5": { single: "belum update", multi: "No yet" },
                "0,75": { single: "belum update", multi: "No yet" },
                "1,0": { single: "belum update", multi: "No yet" },
                "1,5": { single: "belum update", multi: "No yet" },
                "2,5": { single: "belum update", multi: "No yet" },
                "4": { single: "belum update", multi: "No yet" },
                "6": { single: "belum update", multi: "No yet" },
                "10": { single: "belum update", multi: "No yet" },
                "16": { single: "belum update", multi: "No yet" },
                "25": { single: "belum update", multi: "No yet" },
                "35": { single: "belum update", multi: "No yet" },
                "50": { single: "belum update", multi: "No yet" },
                "70": { single: "belum update", multi: "No yet" },
                "95": { single: "belum update", multi: "No yet" },
                "120": { single: "belum update", multi: "No yet" },
                "150": { single: "belum update", multi: "No yet" },
                "185": { single: "belum update", multi: "No yet" },
                "240": { single: "belum update", multi: "No yet" },
                "300": { single: "belum update", multi: "No yet" },
                "400": { single: "belum update", multi: "No yet" },
                "500": { single: "belum update", multi: "No yet" },
                "630": { single: "belum update", multi: "No yet" },
                "800": { single: "belum update", multi: "No yet" },
                "960": { single: "belum update", multi: "No yet" },
                "1000": { single: "belum update", multi: "No yet" },
                "1200": { single: "belum update", multi: "No yet" },
                "1600": { single: "belum update", multi: "No yet" },
                "2000": { single: "belum update", multi: "No yet" }
            },
            AL: {
                "0,5": { single: "belum update", multi: "No yet" },
                "0,75": { single: "belum update", multi: "No yet" },
                "1,0": { single: "belum update", multi: "No yet" },
                "1,5": { single: "belum update", multi: "No yet" },
                "2,5": { single: "belum update", multi: "No yet" },
                "4": { single: "belum update", multi: "No yet" },
                "6": { single: "belum update", multi: "No yet" },
                "10": { single: "belum update", multi: "No yet" },
                "16": { single: "belum update", multi: "No yet" },
                "25": { single: "belum update", multi: "No yet" },
                "35": { single: "belum update", multi: "No yet" },
                "50": { single: "belum update", multi: "No yet" },
                "70": { single: "belum update", multi: "No yet" },
                "95": { single: "belum update", multi: "No yet" },
                "120": { single: "belum update", multi: "No yet" },
                "150": { single: "belum update", multi: "No yet" },
                "185": { single: "belum update", multi: "No yet" },
                "240": { single: "belum update", multi: "No yet" },
                "300": { single: "belum update", multi: "No yet" },
                "400": { single: "belum update", multi: "No yet" },
                "500": { single: "belum update", multi: "No yet" },
                "630": { single: "belum update", multi: "No yet" },
                "800": { single: "belum update", multi: "No yet" },
                "960": { single: "belum update", multi: "No yet" },
                "1000": { single: "belum update", multi: "No yet" },
                "1200": { single: "belum update", multi: "No yet" },
                "1600": { single: "belum update", multi: "No yet" },
                "2000": { single: "belum update", multi: "No yet" }
            },
            TCU: {
                "0,5": { single: "belum update", multi: "No yet" },
                "0,75": { single: "belum update", multi: "No yet" },
                "1,0": { single: "belum update", multi: "No yet" },
                "1,5": { single: "belum update", multi: "No yet" },
                "2,5": { single: "belum update", multi: "No yet" },
                "4": { single: "belum update", multi: "No yet" },
                "6": { single: "belum update", multi: "No yet" },
                "10": { single: "belum update", multi: "No yet" },
                "16": { single: "belum update", multi: "No yet" },
                "25": { single: "belum update", multi: "No yet" },
                "35": { single: "belum update", multi: "No yet" },
                "50": { single: "belum update", multi: "No yet" },
                "70": { single: "belum update", multi: "No yet" },
                "95": { single: "belum update", multi: "No yet" },
                "120": { single: "belum update", multi: "No yet" },
                "150": { single: "belum update", multi: "No yet" },
                "185": { single: "belum update", multi: "No yet" },
                "240": { single: "belum update", multi: "No yet" },
                "300": { single: "belum update", multi: "No yet" },
                "400": { single: "belum update", multi: "No yet" },
                "500": { single: "belum update", multi: "No yet" },
                "630": { single: "belum update", multi: "No yet" },
                "800": { single: "belum update", multi: "No yet" },
                "960": { single: "belum update", multi: "No yet" },
                "1000": { single: "belum update", multi: "No yet" },
                "1200": { single: "belum update", multi: "No yet" },
                "1600": { single: "belum update", multi: "No yet" },
                "2000": { single: "belum update", multi: "No yet" }
            }
        };

        const suhuData = {
            CU: {
                "5": "1.0640",
                "6": "1.0590",
                "7": "1.0550",
                "8": "1.0500",
                "9": "1.0460",
                "10": "1.0420",
                "11": "1.0370",
                "12": "1.0330",
                "13": "1.0290",
                "14": "1.0250",
                "15": "1.0200",
                "16": "1.0160",
                "17": "1.0120",
                "18": "1.0080",
                "19": "1.0040",
                "20": "1.0000",
                "21": "0.9960",
                "22": "0.9920",
                "23": "0.9880",
                "24": "0.9840",
                "25": "0.9800",
                "26": "0.9770",
                "27": "0.9730",
                "28": "0.9690",
                "29": "0.9650",
                "30": "0.9620",
                "31": "0.9580",
                "32": "0.9540",
                "33": "0.9510",
                "34": "0.9470",
                "35": "0.9430",
                "36": "0.9400",
                "37": "0.9360",
                "38": "0.9330",
                "39": "0.9290",
                "40": "0.9260",
                "45": "0.9090",
                "50": "0.8930",
                "55": "0.8770",
                "60": "0.8620",
                "65": "0.8470",
                "70": "0.8330",
                "75": "0.8200",
                "80": "0.8060",
                "85": "0.7940",
                "90": "0.7810"
            },
            AL: {
                "5": "1.0640",
                "6": "1.0590",
                "7": "1.0550",
                "8": "1.0500",
                "9": "1.0460",
                "10": "1.0420",
                "11": "1.0370",
                "12": "1.0330",
                "13": "1.0290",
                "14": "1.0250",
                "15": "1.0200",
                "16": "1.0160",
                "17": "1.0120",
                "18": "1.0080",
                "19": "1.0040",
                "20": "1.0000",
                "21": "0.9960",
                "22": "0.9920",
                "23": "0.9880",
                "24": "0.9840",
                "25": "0.9800",
                "26": "0.9770",
                "27": "0.9730",
                "28": "0.9690",
                "29": "0.9650",
                "30": "0.9620",
                "31": "0.9580",
                "32": "0.9540",
                "33": "0.9510",
                "34": "0.9470",
                "35": "0.9430",
                "36": "0.9400",
                "37": "0.9360",
                "38": "0.9330",
                "39": "0.9290",
                "40": "0.9260",
                "45": "0.9090",
                "50": "0.8930",
                "55": "0.8770",
                "60": "0.8620",
                "65": "0.8470",
                "70": "0.8330",
                "75": "0.8200",
                "80": "0.8060",
                "85": "0.7940",
                "90": "0.7810"
            },
            TCU: {
                "5": "1.0640",
                "6": "1.0590",
                "7": "1.0550",
                "8": "1.0500",
                "9": "1.0460",
                "10": "1.0420",
                "11": "1.0370",
                "12": "1.0330",
                "13": "1.0290",
                "14": "1.0250",
                "15": "1.0200",
                "16": "1.0160",
                "17": "1.0120",
                "18": "1.0080",
                "19": "1.0040",
                "20": "1.0000",
                "21": "0.9960",
                "22": "0.9920",
                "23": "0.9880",
                "24": "0.9840",
                "25": "0.9800",
                "26": "0.9770",
                "27": "0.9730",
                "28": "0.9690",
                "29": "0.9650",
                "30": "0.9620",
                "31": "0.9580",
                "32": "0.9540",
                "33": "0.9510",
                "34": "0.9470",
                "35": "0.9430",
                "36": "0.9400",
                "37": "0.9360",
                "38": "0.9330",
                "39": "0.9290",
                "40": "0.9260",
                "45": "0.9090",
                "50": "0.8930",
                "55": "0.8770",
                "60": "0.8620",
                "65": "0.8470",
                "70": "0.8330",
                "75": "0.8200",
                "80": "0.8060",
                "85": "0.7940",
                "90": "0.7810"
            }
        };

        function getLuasValue() {
            return luasEl.options[luasEl.selectedIndex].value;
        }

        function getGreeting(now) {
            const jam = now.getHours();
            const menit = now.getMinutes();
            const totalMenit = jam * 60 + menit;
            if (totalMenit >= 300 && totalMenit <= 659) return "Selamat Pagi,";
            if (totalMenit >= 660 && totalMenit <= 899) return "Selamat Siang,";
            if (totalMenit >= 900 && totalMenit <= 1079) return "Selamat Sore,";
            if (totalMenit >= 1080 && totalMenit <= 1439) return "Selamat Malam,";
            return "";
        }

        function updateSpec() {
            const bahan = bahanEl.value;
            const luas = getLuasValue();
            spesifikasiEl.value = specData[bahan]?.[luas]?.replace(".", ",") || ""; 
            hitungHasil(); 
        }

        function updateFaktor() {
            const bahan = bahanEl.value;
            const suhuValue = suhuEl.value.replace(",", ".").trim();
            let suhuNumber = parseFloat(suhuValue);
            let faktor = "";
            if (!isNaN(suhuNumber) && suhuData[bahan]) {
                if (suhuData[bahan][suhuNumber]) { 
                    faktor = suhuData[bahan][suhuNumber];
                } else { 
                    faktor = ""; 
                }
            }
            faktorEl.value = faktor.replace(".", ","); 
            hitungHasil(); 
        }

        function isInputLengkap() {
            return alatEl.value.trim() !== "" &&
                document.getElementById("panjang").value.trim() !== "" &&
                suhuEl.value.trim() !== "" &&
                faktorEl.value.trim() !== "";
        }

        function showGreetingHint() {
            const now = new Date();
            const greeting = getGreeting(now);
            if (greeting) {
                hasilStatus.innerHTML = `<span class="hint-green">${greeting} Mohon lengkapi data untuk memulai.</span>`;
            } else {
                hasilStatus.innerHTML = `<span class="hint-green">Mohon lengkapi data, untuk memulai aplikasi ini.</span>`;
            }
            nilaiUtamaEl.textContent = ""; 
            unitOhmKmEl.style.display = "none"; // Sembunyikan unit saat menampilkan hint
            hasilEl.style.color = "inherit";
            specTabelDisplay.textContent = ""; 
        }

        function hitungHasil() {
            let alatNumber = parseFloat(alatEl.value.replace(",", ".")); 
            const panjang = parseFloat(document.getElementById("panjang").value.replace(",", "."));
            const faktor = parseFloat(faktorEl.value.replace(",", ".")); 
            const bahan = bahanEl.value;
            const luas = getLuasValue();
            const specRaw = specData[bahan]?.[luas]?.replace(",", ".");
            const spec = parseFloat(specRaw);

            updateTabelSpecDisplay(); 

            if (!isInputLengkap()) {
                showGreetingHint();
                return;
            }

            if (!isNaN(alatNumber) && !isNaN(panjang) && !isNaN(faktor) && panjang !== 0) {
                const hasil = (alatNumber / panjang) * faktor;
                nilaiUtamaEl.textContent = hasil.toFixed(5); 
                unitOhmKmEl.style.display = "inline"; // Tampilkan unit jika perhitungan berhasil

                if (!isNaN(spec)) {
                    if (hasil < spec) {
                        hasilEl.style.color = "green";
                        hasilStatus.textContent = "Hasil pengujian memenuhi standar. âœ…";
                        hasilStatus.style.color = "green";
                    } else {
                        hasilEl.style.color = "red";
                        hasilStatus.textContent = "Hasil pengujian tidak memenuhi standar. âŒ";
                        hasilStatus.style.color = "red";
                    }
                } else {
                    hasilEl.style.color = "gray";
                    hasilStatus.textContent = "Spec tidak tersedia untuk perbandingan.";
                    hasilStatus.style.color = "gray";
                }
            } else {
                showGreetingHint();
                unitOhmKmEl.style.display = "none"; // Sembunyikan unit jika ada masalah input
            }
        }

        function updateTabelSpecDisplay() {
            const bahan = bahanEl.value;
            const luasValue = getLuasValue(); 
            
            const specCore = tabelSpecData[bahan]?.[luasValue];

            if (specCore) {
                specTabelDisplay.innerHTML = `Jika Single Core : <span class="green-text">${specCore.single}</span> | Jika Multi Core : <span class="green-text">${specCore.multi}</span>`;
            } else {
                specTabelDisplay.textContent = "Data Core : N/A";
            }
        }


        function simpanPengujian() {
            const alat = alatEl.value || "-";
            const alatSatuan = "mÎ© (diasumsikan)"; 
            const panjang = document.getElementById("panjang").value || "-";
            const suhu = suhuEl.value || "-";
            const faktor = faktorEl.value || "-";
            const bahan = bahanEl.options[bahanEl.selectedIndex].text || "-";
            const luas = luasEl.options[luasEl.selectedIndex].text || "-";
            const spesifikasi = spesifikasiEl.value || "-";
            const hasil = nilaiUtamaEl.textContent || "-"; 
            const status = hasilStatus.textContent || "-";
            const specTabel = specTabelDisplay.textContent || "-"; 

            const now = new Date();
            const jamPengujian = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            const tanggalPengujian = now.toLocaleDateString('id-ID');
            laporanPengujian.push({
                alat, alatSatuan, panjang, suhu, faktor, bahan, luas, spesifikasi, hasil: hasil + " Î©/km", status, specTabel, 
                tanggal: tanggalPengujian,
                jam: jamPengujian
            });
            alert("Pengujian berhasil disimpan ke laporan! ðŸ’¾");
        }

        document.getElementById("btn-simpan").addEventListener("click", simpanPengujian);

        bahanEl.addEventListener('change', () => {
            updateSpec();
            updateFaktor(); 
            updateTabelSpecDisplay(); 
        });
        luasEl.addEventListener('change', () => {
                updateSpec();
                updateTabelSpecDisplay(); 
        });
        suhuEl.addEventListener('input', updateFaktor);
        document.getElementById("panjang").addEventListener("input", hitungHasil); 

        document.getElementById("btn-laporan").addEventListener("click", () => {
            if (laporanPengujian.length === 0) {
                alert("Belum ada pengujian yang disimpan dalam laporan.");
                return;
            }

            let isiLaporan = `Laporan Perhitungan Resistansi Konduktor\n`;
            isiLaporan += `Total Pengujian: ${laporanPengujian.length}\n\n`;

            laporanPengujian.forEach((uji, idx) => {
                isiLaporan += `--- Pengujian ke-${idx+1} ---\n`;
                isiLaporan += `Tanggal: ${uji.tanggal}\n`;
                isiLaporan += `Jam   : ${uji.jam}\n\n`;
                isiLaporan += `Input:\n`;
                isiLaporan += `- Pembacaan Alat: ${uji.alat} ${uji.alatSatuan}\n`;
                isiLaporan += `- Panjang (Meter): ${uji.panjang}\n`; 
                isiLaporan += `- Suhu (Â°C): ${uji.suhu}\n`;
                isiLaporan += `- Faktor Koreksi Suhu: ${uji.faktor}\n\n`;
                isiLaporan += `Data Konduktor:\n`;
                isiLaporan += `- Jenis Konduktor: ${uji.bahan}\n`;
                isiLaporan += `- Penampang: ${uji.luas}\n`;
                isiLaporan += `- Spesifikasi Standar: ${uji.spesifikasi}\n`;
                isiLaporan += `- Spek sesuai tabel: ${uji.specTabel}\n\n`; 
                isiLaporan += `Hasil Perhitungan:\n`;
                isiLaporan += `- Resistansi: ${uji.hasil}\n`; 
                isiLaporan += `- Status Pengujian: ${uji.status}\n\n`;
            });

            const blob = new Blob([isiLaporan], {type: "text/plain"});
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "Laporan-Resistansi-Konduktor.txt";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        });

        document.getElementById("btn-iec").addEventListener("click", function() {
            window.location.href = "hk_iec.html";
        });
        document.getElementById("btn-icea").addEventListener("click", function() {
            window.location.href = "hk_icea.html";
        });
        document.getElementById("btn-asnzs").addEventListener("click", function() {
            window.location.href = "hk_as.html";
        });
        document.getElementById("btn-spln").addEventListener("click", function() {
            window.location.href = "hk_spln.html";
        });

        window.addEventListener('DOMContentLoaded', () => {
            bahanEl.value = "CU"; 
            luasEl.value = "0,5"; 
            
            updateSpec();
            updateFaktor();
            updateTabelSpecDisplay(); 
            
            alatEl.focus(); 
            hitungHasil(); 
        });
    </script>
</body>
</html>